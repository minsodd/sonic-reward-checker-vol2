<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SonicLabs Ranking Checker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .container { max-width: 900px; }
        .gradient-bg { background-image: linear-gradient(to right, #6d28d9, #9333ea); }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

<div class="container mx-auto p-8 bg-white rounded-2xl shadow-xl">
    <div class="text-center">
        <h1 class="text-3xl sm:text-4xl font-bold mb-4 text-purple-800">SonicLabs Ranking Checker</h1>
        <p class="text-gray-600 mb-8">
            예상 순위를 입력하면 글로벌 보상과 한국 특별 보상을 합산한 총 예상 수령액을 확인할 수 있습니다.
        </p>
    </div>

    <!-- 입력 -->
    <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-8">
        <div class="w-full sm:w-2/3">
            <label for="rankInput" class="block text-sm font-medium text-gray-700 mb-1">내 예상 순위</label>
            <input type="number" id="rankInput" placeholder="예: 100" class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors">
        </div>
        <button id="calculateBtn" class="w-full sm:w-1/3 px-6 py-2 bg-purple-700 text-white font-bold rounded-lg shadow-md hover:bg-purple-800 transition-colors mt-6 sm:mt-5">
            계산하기
        </button>
    </div>

    <!-- 결과 -->
    <div id="resultOutput" class="p-6 bg-purple-50 rounded-lg border-2 border-dashed border-purple-300 text-center transition-all duration-300 transform scale-95 opacity-0 mb-8">
        <h3 class="text-xl font-bold text-purple-700 mb-2">총 예상 수령액</h3>
        <div class="space-y-1">
            <p class="text-gray-600 text-sm">글로벌 스냅샷 보상: <span id="globalTokens" class="font-bold text-purple-800">0 $S</span></p>
            <p class="text-gray-600 text-sm">한국 특별 보상: <span id="koreanTokens" class="font-bold text-purple-800">0 $S</span></p>
        </div>
        <div class="h-px w-full my-4 gradient-bg"></div>
        <p class="text-2xl font-extrabold text-purple-900">
            <span id="totalTokens">0</span> $S
        </p>
        <p class="text-lg font-bold text-purple-900 mt-1">
            약 <span id="totalUSD">0</span> USD
        </p>
    </div>

    <!-- 미리보기 -->
    <div>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">주요 순위별 예상 수령액</h3>
        <p class="text-gray-600 text-sm mb-4">글로벌 및 한국 보상 합산</p>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="previewGrid"></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const rankInput = document.getElementById('rankInput');
    const calculateBtn = document.getElementById('calculateBtn');
    const resultOutput = document.getElementById('resultOutput');
    const globalTokensSpan = document.getElementById('globalTokens');
    const koreanTokensSpan = document.getElementById('koreanTokens');
    const totalTokensSpan = document.getElementById('totalTokens');
    const totalUSDSpan = document.getElementById('totalUSD');
    const previewGrid = document.getElementById('previewGrid');

    // 구간별 USD 보상표 (시작, 끝, USD 값)
    const globalTable = [
        { range: [1, 10], usd: [11250, 11250] },
        { range: [11, 30], usd: [11250, 4500] },
        { range: [31, 50], usd: [4500, 3750] },
        { range: [51, 100], usd: [3750, 1950] },
        { range: [101, 200], usd: [1950, 750] },
        { range: [201, 300], usd: [750, 675] },
        { range: [301, 500], usd: [675, 563] },
        { range: [501, 1000], usd: [563, 240] }
    ];

    const koreanTable = [
        { range: [1, 5], usd: [3150, 3150] },
        { range: [6, 15], usd: [3150, 1260] },
        { range: [16, 25], usd: [1260, 1050] },
        { range: [26, 50], usd: [1050, 546] },
        { range: [51, 100], usd: [546, 210] },
        { range: [101, 150], usd: [210, 189] },
        { range: [151, 250], usd: [189, 158] },
        { range: [251, 500], usd: [158, 67] }
    ];

    const tokenPriceUSD = 0.31;

    // 선형 보간 함수
    const interpolate = (rank, range, values) => {
        const [r1, r2] = range;
        const [v1, v2] = values;
        if (rank <= r1) return v1;
        if (rank >= r2) return v2;
        const ratio = (rank - r1) / (r2 - r1);
        return v1 + (v2 - v1) * ratio;
    };

    const calculateFromTable = (rank, table) => {
        for (const row of table) {
            const [r1, r2] = row.range;
            if (rank >= r1 && rank <= r2) {
                return interpolate(rank, row.range, row.usd) / tokenPriceUSD;
            }
        }
        return 0;
    };

    const calculateTotal = rank => {
        const global = Math.round(calculateFromTable(rank, globalTable));
        const korean = Math.round(calculateFromTable(rank, koreanTable));
        const total = global + korean;
        const totalUSD = (total * tokenPriceUSD).toFixed(2);
        return { global, korean, total, totalUSD };
    };

    calculateBtn.addEventListener('click', () => {
        const rank = parseInt(rankInput.value, 10);
        if(isNaN(rank) || rank < 1) { alert('유효한 순위를 입력해주세요.'); return; }
        if(rank > 1000) { alert('1000위까지만 지원됩니다.'); return; }

        const { global, korean, total, totalUSD } = calculateTotal(rank);
        globalTokensSpan.textContent = global.toLocaleString() + " $S";
        koreanTokensSpan.textContent = korean.toLocaleString() + " $S";
        totalTokensSpan.textContent = total.toLocaleString();
        totalUSDSpan.textContent = totalUSD.toLocaleString();
        resultOutput.style.opacity = '1';
        resultOutput.style.transform = 'scale(1)';
    });

    // 미리보기 순위
    const previewRanks = [1,10,25,50,100,250,500,750,1000];
    previewGrid.innerHTML = '';
    previewRanks.forEach(rank => {
        const { global, korean, total, totalUSD } = calculateTotal(rank);
        const div = document.createElement('div');
        div.className = "p-4 bg-gray-50 border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow";
        div.innerHTML = `
            <p class="text-lg font-bold text-gray-900">${rank}위</p>
            <p class="text-sm text-purple-700 font-medium mt-1">글로벌: ${global.toLocaleString()} $S</p>
            <p class="text-sm text-purple-700 font-medium mt-1">한국: ${korean.toLocaleString()} $S</p>
            <p class="text-xs text-gray-500">총합: ${total.toLocaleString()} $S (~$${totalUSD})</p>
        `;
        previewGrid.appendChild(div);
    });
});
</script>
</body>
</html>
